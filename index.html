<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>Pathie: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Pathie
   </div>
   <div id="projectbrief">C++ UTF-8 path management library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Pathie Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This is the <a class="el" href="namespacePathie.html" title="Namespace for this library. ">Pathie</a> project. It aims to provide a C++ library that covers all needs of pathname manipulation and filename fiddling, without having to worry about the underlying platform. That is, it is a glue library that allows you to create platform-independent filename handling code with special regard to Unicode path names.</p>
<h2>Supported systems </h2>
<p>Currently supported platforms are Linux with GCC and Windows with GCC (via MinGW). Any other compiler or system might or might not work.</p>
<p>It is recommended to use at least GCC 4.9.0 due to full implementation of C++11.</p>
<h2>The library </h2>
<p>The entire world is using UTF-8 as the primary Unicode encoding. The entire world? No, a little company from Redmond resists the temptation and instead uses UTF-16LE, causing cross-platform handling of Unicode pathes to be a nightmare.</p>
<p>One of the main problems the author ran into was compiler-dependant code that was not marked as such. Many sites on the Internet claim Unicode path handling on Windows is easy, but in fact, it only is if you define “development for Windows” as “development with MSVC”, Microsoft’s proprietary C/C++ compiler, which provides nonstandard interfaces to allow for handling UTF-16LE filenames. The pathie library has been developed with a focus on MinGW and crosscompilation from Linux to Windows and thus does not suffer from this problem. It is guaranteed to work both with native g++ on Linux, native g++ via MinGW on Windows, and crosscompilation MinGW g++ on Linux. I will accept patches for other compilers, but I will not thoroughly test on them.</p>
<p>Even more, Pathie’s author is of the strong opinion that UTF-8 is the correct encoding to use, and is not willing to do differently on Windows. Visit the <a href="http://www.utf8everywhere.org">UTF8 Everywhere</a> website if you need good arguments for this. However, the Windows world of course disagrees, and this is where the pathie library comes in. It allows you to do your entire pathname handling in UTF-8, and transparently converts to whatever pathname encoding the underlying system uses, such as UTF-16LE on Windows, without having you notice.</p>
<h2>Usage </h2>
<p>First thing is to include the main header:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;pathie.hpp&gt;</span></div>
</div><!-- fragment --><p>This will include any other headers as well. There should never be a need to include pathie’s complement headers.</p>
<p>Now consider the simple task to get all children of a directory, which have Unicode filenames. Doing that manually will result in you having to convert between UTF-8 and UTF-16 all the time. With pathie, you can just do this:</p>
<div class="fragment"><div class="line">std::vector&lt;Pathie::Path&gt; children = your_path.children();</div>
</div><!-- fragment --><p>Done. Retrieving the parent directory of your directory is easy as hell:</p>
<div class="fragment"><div class="line"><a class="code" href="classPathie_1_1Path.html">Pathie::Path</a> yourpath(<span class="stringliteral">&quot;foo/bar/baz&quot;</span>);</div>
<div class="line"><a class="code" href="classPathie_1_1Path.html">Pathie::Path</a> parent = yourpath.<a class="code" href="classPathie_1_1Path.html#a3ddc58db2a15515948ec8cc6a03a783e">parent</a>();</div>
</div><!-- fragment --><p>But <a class="el" href="namespacePathie.html" title="Namespace for this library. ">Pathie</a> is much more than just an abstraction of different filepath encodings. It is a utility library for pathname manipulation, i.e. it allows you to do things like finding the parent directory, resolving symlinks (yes, including NTFS symlinks on Windows), expanding relative to absolute pathes, decomposing a filename into basename, dirname, and extension, and so on. See the documentation of the central <a class="el" href="classPathie_1_1Path.html" title="Main class, describing pathes. ">Pathie::Path</a> class on what you can do.</p>
<div class="fragment"><div class="line"><span class="comment">// Assume current directory is /tmp</span></div>
<div class="line"><a class="code" href="classPathie_1_1Path.html">Pathie::Path</a> p(<span class="stringliteral">&quot;foo/bar/../baz&quot;</span>);</div>
<div class="line">p.expand(); <span class="comment">// =&gt; /tmp/foo/baz</span></div>
</div><!-- fragment --><p>Or my personal favourite:</p>
<div class="fragment"><div class="line"><a class="code" href="classPathie_1_1Path.html">Pathie::Path</a> p1(<span class="stringliteral">&quot;/tmp/foo/bar&quot;</span>);</div>
<div class="line"><a class="code" href="classPathie_1_1Path.html">Pathie::Path</a> p2(<span class="stringliteral">&quot;/tmp/bar/foo&quot;</span>);</div>
<div class="line"><a class="code" href="classPathie_1_1Path.html">Pathie::Path</a> p3 = p1.<a class="code" href="classPathie_1_1Path.html#ae809e07fd6bcfe85eb5db5e569e37549">relative</a>(p2); <span class="comment">// =&gt; ../../foo/bar</span></div>
</div><!-- fragment --><p>It also provides you with commonly used pathes like the user’s configuration directory or the path to the running executable.</p>
<div class="fragment"><div class="line"><a class="code" href="classPathie_1_1Path.html">Pathie::Path</a> exepath = <a class="code" href="classPathie_1_1Path.html#a870c9096d4c1abc85018df980df3968f">Pathie::Path::exe</a>();</div>
</div><!-- fragment --><p>And best of it? All arguments you pass to <a class="el" href="namespacePathie.html" title="Namespace for this library. ">Pathie</a> are UTF-8, and everything you get back is encoded in UTF-8 as well.</p>
<p>Still, if you interface directly with the Windows API or other external libraries, you might want to retrieve the native representation from a Path or construct a Path from the native representation. <a class="el" href="namespacePathie.html" title="Namespace for this library. ">Pathie</a> doesn’t want to be in your way then:</p>
<div class="fragment"><div class="line"><span class="comment">// Contruct from native</span></div>
<div class="line"><span class="keywordtype">wchar_t</span>* utf16 = Win32ApiCall();</div>
<div class="line">Path mypath = Path::from_native(utf16); <span class="comment">// also accepts std::wstring</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// Retrieve native (Note C++’ish std::wstring rather than</span></div>
<div class="line"><span class="comment">// raw wchar_t*)</span></div>
<div class="line">std::wstring native_utf16 = mypath.native();</div>
</div><!-- fragment --><p>On UNIX, these methods work with normal strings in the underlying filesystem encoding. In most cases, that will be UTF-8, but some legacy systems may still use something like ISO-8859-1 in which case that will differ. Therefore, only use the <code>Path</code> constructor if you are constructing from a UTF-8 string!</p>
<h3>Stream replacements</h3>
<p><a class="el" href="namespacePathie.html" title="Namespace for this library. ">Pathie</a> mainly provides you with the means to handle pathes, compose, and decompose them. Inspired by the <a href="http://cppcms.com/files/nowide/html/">boost::nowide library</a> library, however, it also provides you with drop-in replacements for <code>std::ifstream</code> and <code>std::ofstream</code> that flawlessly work on Unicode pathes even on Windows. See the documentation of <a class="el" href="classPathie_1_1ofstream.html" title="Output stream for UTF-8-encoded filenames. ">Pathie::ofstream</a> for more information.</p>
<div class="fragment"><div class="line"><a class="code" href="classPathie_1_1Path.html">Pathie::Path</a> p(<span class="stringliteral">&quot;Bärenstark.txt&quot;</span>);</div>
<div class="line"><a class="code" href="classPathie_1_1ofstream.html">Pathie::ofstream</a> file(p);</div>
<div class="line">file &lt;&lt; <span class="stringliteral">&quot;Some content&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">file.close()</div>
</div><!-- fragment --><h2>Dependencies and linking </h2>
<p><a class="el" href="namespacePathie.html" title="Namespace for this library. ">Pathie</a> is standalone, that is, it requires no other libraries except for those provided by your operating system. Note that there’s a caveat with this on Windows, which does provide the <code>shlwapi.lib</code> library by default, but does not automatically link it in. Be sure to add that library to your linking command when compiling for Windows.</p>
<p>It is recommended to link in pathie as a dynamic library, because there are some problems with it when linked statically on certain operating systems (see <em>Caveats</em> below). If you are sure you aren’t affected by those problems, it is possible to link in pathie statically.</p>
<h2>Caveats </h2>
<p>This library assumes that under all UNIX systems out there (I also consider Mac OSX to be a UNIX system) the file system root always is <code>/</code> and the directory separator also always is <code>/</code>. This structure is mandatory as per POSIX &ndash; in POSIX.1-2008, it’s specified in section 10.1. Systems which do neither follow POSIX directory structure, nor are Windows, are unsupported.</p>
<p>On POSIX-compliant systems other than Mac OS X, the filesystem encoding <a href="https://unix.stackexchange.com/questions/2089/what-charset-encoding-is-used-for-filenames-and-paths-on-linux">generally is unspecified</a>. Pathnames are merely byte blobs which do not contain NUL bytes, and components are separated by <code>/</code>. It’s up to the applications, including utilities like a shell or the ls(1) program, to make something of those byte streams. Therefore, it is perfectly possible that on one system, user A uses ISO-8859-1 filenames and user B uses UTF-8 filenames. Even the same user could use differently encoded filenames. Programs that have to interpret the byte blobs in pathnames on these systems look at the locale environment variables, namely <code>LANG</code> and <code>LC_ALL</code>, see section 7 of POSIX.1-2008. As a consequence, it may happen you want to create filenames with characters not supported in the user’s pathname encoding. For example, if you want to create a file with a hebrew filename and the user’s pathname encoding is ISO-8859-1, there’s a problem, because ISO-8859-1 has no hebrew characters in it, but in UTF-8, which is the encoding you are advised to use and which is what Pathie’s API expects from you, they are available. There is no sensible solution to this problem that the <a class="el" href="namespacePathie.html" title="Namespace for this library. ">Pathie</a> library could dictate; the <code>iconv()</code> function used by pathie just replaces characters that are unavailable in the target encoding with a system-defined default (probably “?”). Note that on systems which have a Unicode pathname encoding, especially modern Linuxes with UTF-8, such a situation can’t ever arise, because the Unicode encodings (UTF-*) cover all characters you can ever use.</p>
<p>Note a possible problem in <a class="el" href="classPathie_1_1Path.html#aa056dfe6643d1294a67fc4c5b5bc04ad" title="Expands all shortcuts plus create an absolute path for this path. ">Pathie::Path::expand()</a> when you link <a class="el" href="namespacePathie.html" title="Namespace for this library. ">Pathie</a> in statically and depend on expanding pathes like <code>~username/foo</code> on UNIX. See <a class="el" href="classPathie_1_1Path.html#aa056dfe6643d1294a67fc4c5b5bc04ad" title="Expands all shortcuts plus create an absolute path for this path. ">Pathie::Path::expand()</a> docs for information on this.</p>
<p>At least on FreeBSD, calling the POSIX <code>iconv()</code> function fails with the cryptic error message “Service unavailable” if a program is linked statically. I’ve reported <a href="https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=196567">a bug on this</a>. This means that you currently can’t link in pathie statically on FreeBSD and systems which don’t allow statically linked executables to call <code>iconv()</code>.</p>
<p>It is recommended to set your program’s locale to the environment’s locale before you call any functions the <a class="el" href="namespacePathie.html" title="Namespace for this library. ">Pathie</a> library provides on a UNIX system, because this will allow <a class="el" href="namespacePathie.html" title="Namespace for this library. ">Pathie</a> to use the correct encoding for filenames on UNIX systems. This is relevant where the environment’s encoding is not UTF-8, e.g. with $LANG set to <code>de_DE.ISO-8859-1</code>. You can do this as follows (the <code>""</code> locale always refers to the locale of the environment):</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;locale&gt;</span></div>
<div class="line">std::locale::global(std::locale(<span class="stringliteral">&quot;&quot;</span>));</div>
</div><!-- fragment --><h2>Don’t you duplicate boost::filesystem? </h2>
<p>Yes and no. <a href="http://www.boost.org/doc/libs/1_56_0/libs/filesystem/doc/index.htm">boost::filesystem</a> provides many methods pathie provides, but has a major problem with Unicode path handling if you are not willing to do the UTF-8/UTF-16 conversion manually. boost::filesystem always uses UTF-8 to store the pathes on UNIX, and, which is the problem, always uses UTF-16LE to store the pathes on a Windows system. There is no way to override this, although there is a <a href="http://www.boost.org/doc/libs/1_51_0/libs/locale/doc/html/default_encoding_under_windows.html">hidden documentation page</a> that claims to solve the problem. I have wasted a great amount of time to persuade boost::filesystem to automatically convert all <code>std::string</code> input it receives into UTF-16LE, but failed to succeed. Each time I wanted to create a file with a Unicode filename, the test failed on Windows by producing garbage filenames. Finally I found out that the neat trick shown in the documentation above indeed does work &ndash; but only if you use the Microsoft Visual C++ compiler (MSVC) to compile your code. I don’t, I generally use g++ via the <a href="http://www.mingw.org">MinGW</a> toolchain. boost::filesystem fails with g++ via MinGW with regard to Unicode filenames on Windows entirely and completely as of this writing (September 2014).</p>
<p>Apart from that, pathie provides some additional methods, especially with regard to finding out where the user’s pathes are. It is modelled after Ruby’s popular <a href="http://ruby-doc.org/stdlib-2.1.2/libdoc/pathname/rdoc/Pathname.html#method-i-rmtree">Pathname</a> class, but it doesn’t entirely duplicate its interface (which wouldn’t be idiomatic C++).</p>
<p>Also, pathie is a small library. Adding it to your project shouldn’t hurt too much, while boost::filesystem is quite a large dependency.</p>
<h2>Contributing </h2>
<p>This library is free software under the GPL (see <em>License</em> below), so you can basically do with it as you like. If you want me to include your changes into the main repository, I will happily do so after you have signed a Contributor License Agreement (CLA) as outlined at <a href="http://www.guelkerdev.de/contributing/">http://www.guelkerdev.de/contributing/</a>. I’ll ask you to do so if you submit something to me, so don’t worry if you forget it.</p>
<p>Other than that, the usual things apply. Try to make separate branches for your new features, give a description on what you changed, etc. The main unstable development branch is <code>devel</code>, so unless you are working on release-specific fixes this is where you should target your PR at.</p>
<h2>License </h2>
<p><a class="el" href="namespacePathie.html" title="Namespace for this library. ">Pathie</a> is a path management library.</p>
<p>Copyright © 2015 Marvin Gülker</p>
<p>This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.</p>
<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with this program. If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.</p>
<h3>Commercial use</h3>
<p>If you have the urgent feeling that you don’t want to help free software to spread, feel free to contact me. We might be able to work something out on an individual base.</p>
<h3>Contact information</h3>
<p>My email address is <a href="#" onclick="location.href='mai'+'lto:'+'m-g'+'ue'+'lke'+'r@'+'gue'+'lk'+'erd'+'ev'+'.de'; return false;">m-gue<span style="display: none;">.nosp@m.</span>lker<span style="display: none;">.nosp@m.</span>@guel<span style="display: none;">.nosp@m.</span>kerd<span style="display: none;">.nosp@m.</span>ev.de</a>. You can find my paper mail address on <a href="http://www.guelkerdev.de">my website</a>.</p>
<p><em>To not use UTF-16LE, nevermore…</em> </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Feb 13 2015 20:52:24 for Pathie by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
